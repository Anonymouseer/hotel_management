<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hotel Channel Manager Pro</title>
    <style>
        /* Reset and Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --success: #27ae60;
            --warning: #f39c12;
            --danger: #e74c3c;
            --light: #ecf0f1;
            --dark: #34495e;
            --gray: #95a5a6;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f8f9fa;
            color: #333;
            line-height: 1.6;
        }

        /* Page Management */
        .page {
            display: none;
            min-height: 100vh;
        }

        .page.active {
            display: block;
        }

        /* Login Styles */
        .login-container {
            max-width: 400px;
            margin: 100px auto;
            padding: 40px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            text-align: center;
        }

        .login-container h2 {
            margin-bottom: 30px;
            color: var(--primary);
            font-size: 28px;
        }

        .login-container input,
        .login-container select {
            width: 100%;
            padding: 12px 15px;
            margin: 10px 0;
            border: 2px solid #e1e8ed;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .login-container input:focus,
        .login-container select:focus {
            border-color: var(--secondary);
            outline: none;
        }

        .login-container button {
            width: 100%;
            padding: 12px;
            background: var(--secondary);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            margin-top: 15px;
            transition: background 0.3s;
        }

        .login-container button:hover {
            background: #2980b9;
        }

        /* Header Styles */
        header {
            background: var(--primary);
            color: white;
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header-info {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .user-info {
            background: rgba(255,255,255,0.1);
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 14px;
        }

        header button {
            padding: 8px 16px;
            background: var(--danger);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s;
        }

        header button:hover {
            background: #c0392b;
        }

        /* Dashboard Styles */
        .dashboard {
            padding: 30px;
            max-width: 1400px;
            margin: 0 auto;
        }

        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            text-align: center;
            border-left: 4px solid var(--secondary);
        }

        .stat-card h3 {
            font-size: 14px;
            color: var(--gray);
            margin-bottom: 10px;
            text-transform: uppercase;
        }

        .stat-card .value {
            font-size: 32px;
            font-weight: bold;
            color: var(--primary);
        }

        .stat-card .trend {
            font-size: 12px;
            margin-top: 5px;
        }

        .trend.positive { color: var(--success); }
        .trend.negative { color: var(--danger); }

        /* Controls */
        .controls {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            flex-wrap: wrap;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .controls button {
            padding: 10px 20px;
            background: var(--secondary);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
        }

        .controls button:hover {
            background: #2980b9;
            transform: translateY(-1px);
        }

        .controls button.active {
            background: var(--primary);
        }

        /* Sections */
        .section {
            display: none;
            animation: fadeIn 0.3s ease-in;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Channel Grid */
        .channel-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin: 25px 0;
        }

        .channel-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            border-left: 4px solid var(--secondary);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .channel-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.12);
        }

        .channel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }

        .channel-header h4 {
            color: var(--primary);
            font-size: 18px;
        }

        .channel-status {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
        }

        .status-connected { background: #d5f4e6; color: var(--success); }
        .status-disconnected { background: #fdeaea; color: var(--danger); }
        .status-syncing { background: #fff3cd; color: var(--warning); }

        /* Room Controls */
        .room-control {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 12px 0;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 8px;
            transition: background 0.3s;
        }

        .room-control:hover {
            background: #e9ecef;
        }

        .room-info {
            flex: 1;
        }

        .room-name {
            font-weight: 600;
            color: var(--primary);
        }

        .room-price {
            font-size: 12px;
            color: var(--gray);
        }

        .room-actions {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .room-actions select,
        .room-actions input {
            padding: 6px 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }

        .room-actions input {
            width: 80px;
        }

        /* Currency Selector */
        .currency-selector {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            padding: 10px 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .currency-selector label {
            font-weight: 600;
            color: var(--primary);
        }

        .currency-selector select {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }

        /* Buttons */
        .sync-btn {
            padding: 12px 25px;
            background: var(--success);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            margin-top: 20px;
            font-size: 16px;
            transition: background 0.3s;
        }

        .sync-btn:hover {
            background: #219a52;
        }

        .sync-btn:disabled {
            background: var(--gray);
            cursor: not-allowed;
        }

        .add-btn {
            padding: 10px 20px;
            background: #9b59b6;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            margin-top: 15px;
            transition: background 0.3s;
        }

        .add-btn:hover {
            background: #8e44ad;
        }

        /* Admin Styles */
        .admin-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(450px, 1fr));
            gap: 25px;
        }

        .admin-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }

        .admin-card h4 {
            color: var(--primary);
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }

        /* Room List */
        .room-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-top: 25px;
        }

        .room-item {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            transition: transform 0.3s;
        }

        .room-item:hover {
            transform: translateY(-3px);
        }

        .room-item h4 {
            color: var(--primary);
            margin-bottom: 10px;
            font-size: 18px;
        }

        .room-meta {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            font-size: 14px;
        }

        .room-price-tag {
            font-size: 24px;
            font-weight: bold;
            color: var(--success);
            margin: 10px 0;
        }

        .channel-availability {
            margin: 15px 0;
        }

        .channel-tag {
            display: inline-block;
            padding: 4px 8px;
            margin: 2px;
            background: #e1f5fe;
            color: #0288d1;
            border-radius: 4px;
            font-size: 12px;
        }

        .book-btn {
            width: 100%;
            padding: 12px;
            background: var(--success);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            margin-top: 15px;
            font-size: 16px;
            transition: background 0.3s;
        }

        .book-btn:hover {
            background: #219a52;
        }

        .book-btn:disabled {
            background: var(--gray);
            cursor: not-allowed;
        }

        /* Status Indicators */
        .status-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .status-available { background: var(--success); }
        .status-limited { background: var(--warning); }
        .status-soldout { background: var(--danger); }

        /* Loading States */
        .loading {
            opacity: 0.6;
            pointer-events: none;
        }

        .sync-progress {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
            display: none;
        }

        /* Toast Notifications */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            border-left: 4px solid var(--success);
            z-index: 1000;
            transform: translateX(400px);
            transition: transform 0.3s;
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast.error {
            border-left-color: var(--danger);
        }

        .toast.warning {
            border-left-color: var(--warning);
        }

        /* Dynamic Pricing Controls */
        .dynamic-pricing-controls {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            margin-bottom: 20px;
        }

        .pricing-strategy {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .strategy-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid var(--secondary);
        }

        .strategy-card h5 {
            color: var(--primary);
            margin-bottom: 15px;
            font-size: 16px;
        }

        .strategy-params {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .param-group {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .param-group label {
            font-size: 14px;
            color: var(--dark);
        }

        .param-group input {
            width: 80px;
            padding: 5px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        /* Booking.com Specific Styles */
        .booking-com-adjustment {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .booking-com-adjustment input {
            width: 60px;
            padding: 6px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        .booking-com-adjustment span {
            font-weight: 600;
        }

        .booking-com-commission {
            font-size: 14px;
            color: var(--dark);
            margin-bottom: 15px;
            text-align: center;
            background: #e8f4fd;
            padding: 8px;
            border-radius: 4px;
        }

        .booking-com-apply {
            width: 100%;
            padding: 8px;
            background: #003580;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.3s;
        }

        .booking-com-apply:hover {
            background: #002c6f;
        }

        /* Enhanced Pricing Styles */
        .pricing-breakdown {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            font-size: 14px;
        }
        
        .pricing-line {
            display: flex;
            justify-content: space-between;
            margin: 5px 0;
        }
        
        .pricing-total {
            border-top: 1px solid #ddd;
            padding-top: 8px;
            margin-top: 8px;
            font-weight: bold;
            color: var(--success);
        }
        
        .pricing-header {
            font-weight: bold;
            margin-bottom: 10px;
            color: var(--primary);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .dashboard {
                padding: 15px;
            }

            .channel-grid,
            .admin-grid {
                grid-template-columns: 1fr;
            }

            .controls {
                flex-direction: column;
            }

            .room-control {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }

            .room-actions {
                width: 100%;
                justify-content: space-between;
            }
        }
    </style>
</head>
<body>
    <!-- Login Page -->
    <div id="loginPage" class="page active">
        <div class="login-container">
            <h2>🏨 Channel Manager Pro</h2>
            <form id="loginForm">
                <input type="text" id="username" placeholder="Username" required>
                <input type="password" id="password" placeholder="Password" required>
                <select id="userRole">
                    <option value="staff">Hotel Staff</option>
                    <option value="admin">System Admin</option>
                </select>
                <button type="submit">Login to Dashboard</button>
            </form>
            <div style="margin-top: 20px; font-size: 12px; color: #666;">
                <p><strong>Demo Credentials:</strong></p>
                <p>Staff: staff / staff123</p>
                <p>Admin: admin / admin123</p>
            </div>
        </div>
    </div>

    <!-- Staff Dashboard -->
    <div id="staffDashboard" class="page">
        <header>
            <h2>🏨 Staff Dashboard - Channel Management</h2>
            <div class="header-info">
                <span class="user-info">Staff: <span id="staffName">Loading...</span></span>
                <span class="user-info" id="lastSync">Last sync: --</span>
                <button onclick="logout()">Logout</button>
            </div>
        </header>
        <div class="dashboard">
            <div class="stats-grid">
                <div class="stat-card">
                    <h3>Active Channels</h3>
                    <div class="value" id="activeChannels">--</div>
                    <div class="trend">3 connected</div>
                </div>
                <div class="stat-card">
                    <h3>Pending Sync</h3>
                    <div class="value" id="pendingSync">--</div>
                    <div class="trend negative">2 updates queued</div>
                </div>
            </div>

            <div class="controls">
                <button onclick="showSection('availability')" class="active">📊 Room Availability</button>
                <button onclick="showSection('bookings')">📅 View Bookings</button>
                <button onclick="showSection('reports')">📈 Performance Reports</button>
            </div>
            
            <!-- Availability Management -->
            <div id="availability" class="section active">
                <h3>Manage Room Availability Across Channels</h3>
                <div class="currency-selector">
                    <label for="staffCurrency">Display Prices In:</label>
                    <select id="staffCurrency" onchange="updateAvailabilityDisplay()">
                        <option value="USD">US Dollar ($)</option>
                        <option value="EUR">Euro (€)</option>
                        <option value="GBP">British Pound (£)</option>
                        <option value="PHP">Philippine Peso (₱)</option>
                        <option value="JPY">Japanese Yen (¥)</option>
                    </select>
                </div>
                <div class="sync-progress" id="syncProgress">
                    <strong>Syncing channels...</strong>
                    <div>Updating availability across all connected platforms</div>
                </div>
                <div class="channel-grid" id="channelAvailabilityGrid"></div>
                <button onclick="syncAllChannels()" class="sync-btn" id="syncButton">
                    🔄 Sync All Channels Now
                </button>
            </div>

            <!-- Bookings View -->
            <div id="bookings" class="section">
                <h3>Recent Bookings & Reservations</h3>
                <div id="bookingsList"></div>
            </div>

            <!-- Reports -->
            <div id="reports" class="section">
                <h3>Performance Analytics</h3>
                <div id="reportsContent"></div>
            </div>
        </div>
    </div>

    <!-- Admin Dashboard -->
    <div id="adminDashboard" class="page">
        <header>
            <h2>🏨 Admin Dashboard - System Management</h2>
            <div class="header-info">
                <span class="user-info">System Administrator</span>
                <span class="user-info">Hotel: Grand Plaza Hotel</span>
                <button onclick="logout()">Logout</button>
            </div>
        </header>
        <div class="dashboard">
            <div class="controls">
                <button onclick="showAdminSection('channelConfig')" class="active">🔗 Channel Configuration</button>
                <button onclick="showAdminSection('rateManagement')">💰 Dynamic Rate Management</button>
            </div>

            <!-- Channel Configuration -->
            <div id="channelConfig" class="section active">
                <h3>OTA Channel Configuration & API Management</h3>
                <div class="admin-grid">
                    <div class="admin-card">
                        <h4>Connected Channels</h4>
                        <div id="connectedChannels"></div>
                        <button onclick="showAddChannelModal()" class="add-btn">+ Add New Channel</button>
                    </div>
                    <div class="admin-card">
                        <h4>API Settings & Integration</h4>
                        <div id="apiSettings"></div>
                    </div>
                </div>
            </div>

            <!-- Dynamic Rate Management -->
            <div id="rateManagement" class="section">
                <h3>Dynamic Rate Management</h3>
                <div class="currency-selector">
                    <label for="adminCurrency">Display Prices In:</label>
                    <select id="adminCurrency" onchange="updateRateManagement()">
                        <option value="USD">US Dollar ($)</option>
                        <option value="EUR">Euro (€)</option>
                        <option value="GBP">British Pound (£)</option>
                        <option value="PHP">Philippine Peso (₱)</option>
                        <option value="JPY">Japanese Yen (¥)</option>
                    </select>
                </div>
                
                <!-- Dynamic Pricing Controls -->
                <div class="dynamic-pricing-controls">
                    <h4>🎯 Dynamic Pricing Strategies</h4>
                    <div class="pricing-strategy">
                        <div class="strategy-card">
                            <h5>Expedia Smart Pricing</h5>
                            <div class="strategy-params">
                                <div class="param-group">
                                    <label>Demand Sensitivity:</label>
                                    <input type="number" id="expediaDemand" value="15" min="0" max="50">%
                                </div>
                                <div class="param-group">
                                    <label>Competitor Adjustment:</label>
                                    <input type="number" id="expediaCompetitor" value="5" min="0" max="20">%
                                </div>
                                <div class="param-group">
                                    <label>Seasonal Multiplier:</label>
                                    <input type="number" id="expediaSeasonal" value="10" min="0" max="30">%
                                </div>
                                <button onclick="applyExpediaPricing()" style="padding: 8px 12px; background: #3498db; color: white; border: none; border-radius: 4px; cursor: pointer; margin-top: 10px;">
                                    Apply Expedia Pricing
                                </button>
                            </div>
                        </div>
                        <div class="strategy-card">
                            <h5>Hotel Website Pricing</h5>
                            <div class="strategy-params">
                                <div class="param-group">
                                    <label>Direct Booking Discount:</label>
                                    <input type="number" id="websiteDiscount" value="6" min="0" max="15">%
                                </div>
                                <div class="param-group">
                                    <label>Loyalty Bonus:</label>
                                    <input type="number" id="websiteLoyalty" value="9" min="0" max="10">%
                                </div>
                                <div class="param-group">
                                    <label>Early Bird Special:</label>
                                    <input type="number" id="websiteEarlyBird" value="7" min="0" max="20">%
                                </div>
                                <button onclick="applyWebsitePricing()" style="padding: 8px 12px; background: #9b59b6; color: white; border: none; border-radius: 4px; cursor: pointer; margin-top: 10px;">
                                    Apply Website Pricing
                                </button>
                            </div>
                        </div>
                        <div class="strategy-card">
                            <h5>Booking.com Pricing</h5>
                            <div class="strategy-params">
                                <div style="margin-bottom: 15px;">
                                    <label style="display: block; margin-bottom: 8px; font-weight: 600;">Channel-Specific Adjustment:</label>
                                    <div class="booking-com-adjustment">
                                        <input type="number" id="bookingAdjustment" value="5" min="0" max="50">
                                        <span>%</span>
                                        <button onclick="applyBookingPricing()" class="booking-com-apply">Apply</button>
                                    </div>
                                </div>
                                <div class="booking-com-commission">
                                    Commission: 15%
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="rateControls"></div>
                <button onclick="syncRateChanges()" class="sync-btn" id="rateSyncButton">
                    🔄 Sync Rate Changes to All Channels
                </button>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>

    <!-- Add Channel Modal -->
    <div id="addChannelModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 2000; justify-content: center; align-items: center;">
        <div style="background: white; padding: 30px; border-radius: 12px; width: 90%; max-width: 500px;">
            <h3>Add New OTA Channel</h3>
            <form id="addChannelForm" onsubmit="return addNewChannel(event)">
                <input type="text" id="newChannelName" placeholder="Channel Name (e.g., Airbnb, Agoda)" required style="width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ddd; border-radius: 6px;">
                <input type="text" id="newChannelAPI" placeholder="API Key" required style="width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ddd; border-radius: 6px;">
                <input type="text" id="newChannelURL" placeholder="API Endpoint URL" required style="width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ddd; border-radius: 6px;">
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button type="submit" style="flex: 1; padding: 10px; background: var(--success); color: white; border: none; border-radius: 6px; cursor: pointer;">Add Channel</button>
                    <button type="button" onclick="hideAddChannelModal()" style="flex: 1; padding: 10px; background: var(--gray); color: white; border: none; border-radius: 6px; cursor: pointer;">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Enhanced Realistic Data Model with Currency Support
        const hotelData = {
            hotel: {
                name: "Grand Plaza Hotel",
                currency: "USD",
                timezone: "America/New_York",
                settings: {
                    autoSync: true,
                    syncInterval: 30,
                    minStay: 1,
                    maxStay: 30
                }
            },
            rooms: [
                { 
                    id: 1, 
                    name: "Standard King Room", 
                    type: "standard",
                    basePrice: 129,
                    maxOccupancy: 2,
                    amenities: ["WiFi", "TV", "AC", "Coffee Maker"],
                    totalInventory: 20,
                    description: "Comfortable standard room with king bed"
                },
                { 
                    id: 2, 
                    name: "Deluxe Double Room", 
                    type: "deluxe",
                    basePrice: 159,
                    maxOccupancy: 4,
                    amenities: ["WiFi", "TV", "AC", "Mini Bar", "Work Desk"],
                    totalInventory: 15,
                    description: "Spacious deluxe room with two double beds"
                },
                { 
                    id: 3, 
                    name: "Executive Suite", 
                    type: "suite",
                    basePrice: 249,
                    maxOccupancy: 3,
                    amenities: ["WiFi", "TV", "AC", "Mini Bar", "Work Desk", "Sitting Area"],
                    totalInventory: 8,
                    description: "Luxury suite with separate living area"
                },
                { 
                    id: 4, 
                    name: "Presidential Suite", 
                    type: "premium",
                    basePrice: 499,
                    maxOccupancy: 4,
                    amenities: ["WiFi", "TV", "AC", "Mini Bar", "Work Desk", "Sitting Area", "Jacuzzi"],
                    totalInventory: 2,
                    description: "Ultra-luxury suite with premium amenities"
                }
            ],
            channels: [
                { 
                    id: 1, 
                    name: "Booking.com", 
                    connected: true, 
                    apiKey: "bkg_7x83h2k9d1l0p5",
                    endpoint: "https://api.booking.com/v2/",
                    lastSync: new Date(),
                    syncStatus: "success",
                    commission: 15.0
                },
                { 
                    id: 2, 
                    name: "Expedia", 
                    connected: true, 
                    apiKey: "exp_4m9n2b8v6c3x1",
                    endpoint: "https://api.expedia.com/v1/",
                    lastSync: new Date(Date.now() - 3600000),
                    syncStatus: "pending",
                    commission: 12.5
                },
                { 
                    id: 3, 
                    name: "Hotel Website", 
                    connected: true, 
                    apiKey: "web_2k9d1l0p5h7x83",
                    endpoint: "https://api.grandplazahotel.com/v1/",
                    lastSync: new Date(),
                    syncStatus: "success",
                    commission: 0.0
                }
            ],
            users: [
                { username: "staff", password: "staff123", role: "staff", name: "John Manager", permissions: ["availability", "rates", "reports"] },
                { username: "admin", password: "admin123", role: "admin", name: "Sarah Administrator", permissions: ["all"] }
            ],
            bookings: [
                {
                    id: 1001,
                    roomId: 1,
                    channel: "Booking.com",
                    guestName: "Michael Brown",
                    checkIn: new Date(Date.now() + 86400000),
                    checkOut: new Date(Date.now() + 259200000),
                    totalAmount: 645,
                    status: "confirmed"
                },
                {
                    id: 1002,
                    roomId: 2,
                    channel: "Hotel Website",
                    guestName: "Emily Johnson",
                    checkIn: new Date(Date.now() + 172800000),
                    checkOut: new Date(Date.now() + 345600000),
                    totalAmount: 954,
                    status: "confirmed"
                }
            ],
            availability: {},
            rates: {}
        };

        // Currency Exchange Rates (simplified)
        const exchangeRates = {
            USD: 1.00,
            EUR: 0.92,
            GBP: 0.79,
            PHP: 56.50,
            JPY: 150.25
        };

        // Application State
        let currentUser = null;
        let isSyncing = false;
        let lastUpdateTime = new Date();

        // Initialize application
        function initializeApp() {
            initializeAvailabilityData();
            initializeRateData();
            loadStats();
            
            // Load saved data from localStorage if available
            loadFromLocalStorage();
        }

        function initializeAvailabilityData() {
            hotelData.rooms.forEach(room => {
                hotelData.availability[room.id] = {};
                hotelData.channels.forEach(channel => {
                    if (channel.connected) {
                        const baseAllocation = Math.floor(room.totalInventory * 0.7);
                        const sold = Math.floor(Math.random() * baseAllocation);
                        hotelData.availability[room.id][channel.id] = {
                            available: sold < baseAllocation,
                            allocation: baseAllocation,
                            sold: sold,
                            remaining: baseAllocation - sold,
                            stopSell: false
                        };
                    }
                });
            });
        }

        function initializeRateData() {
            hotelData.rooms.forEach(room => {
                hotelData.rates[room.id] = {};
                hotelData.channels.forEach(channel => {
                    if (channel.connected) {
                        const channelMultiplier = channel.name === "Hotel Website" ? 1.0 : (1 - channel.commission / 100);
                        hotelData.rates[room.id][channel.id] = {
                            basePrice: room.basePrice,
                            channelPrice: Math.round(room.basePrice / channelMultiplier),
                            minPrice: Math.round(room.basePrice * 0.8),
                            maxPrice: Math.round(room.basePrice * 1.4)
                        };
                    }
                });
            });
        }

        // Currency Conversion Functions
        function convertCurrency(amount, fromCurrency, toCurrency) {
            if (fromCurrency === toCurrency) return amount;
            const usdAmount = amount / exchangeRates[fromCurrency];
            return usdAmount * exchangeRates[toCurrency];
        }

        function formatCurrency(amount, currency) {
            const symbols = {
                USD: '$',
                EUR: '€',
                GBP: '£',
                PHP: '₱',
                JPY: '¥'
            };
            
            const formatted = new Intl.NumberFormat('en-US', {
                style: 'currency',
                currency: currency,
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(amount);
            
            return formatted.replace(currency, symbols[currency]);
        }

        // Local Storage Management
        function saveToLocalStorage() {
            localStorage.setItem('hotelChannelManager', JSON.stringify(hotelData));
        }

        function loadFromLocalStorage() {
            const saved = localStorage.getItem('hotelChannelManager');
            if (saved) {
                const parsed = JSON.parse(saved);
                Object.assign(hotelData, parsed);
            }
        }

        // Authentication System
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const role = document.getElementById('userRole').value;
            
            const user = hotelData.users.find(u => 
                u.username === username && u.password === password && u.role === role
            );
            
            if (user) {
                currentUser = user;
                showToast(`Welcome back, ${user.name}!`, 'success');
                showDashboard(user.role);
                saveToLocalStorage();
            } else {
                showToast('Invalid credentials! Please check your username and password.', 'error');
            }
        });

        function showDashboard(role) {
            document.getElementById('loginPage').classList.remove('active');
            
            const dashboards = ['staffDashboard', 'adminDashboard'];
            dashboards.forEach(dash => {
                document.getElementById(dash).classList.remove('active');
            });
            
            switch(role) {
                case 'staff':
                    document.getElementById('staffDashboard').classList.add('active');
                    document.getElementById('staffName').textContent = currentUser.name;
                    updateLastSyncTime();
                    loadStaffDashboard();
                    break;
                case 'admin':
                    document.getElementById('adminDashboard').classList.add('active');
                    loadAdminDashboard();
                    break;
            }
        }

        function logout() {
            currentUser = null;
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById('loginPage').classList.add('active');
            document.getElementById('loginForm').reset();
            showToast('You have been logged out successfully.', 'success');
        }

        // Toast Notification System
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = 'toast';
            toast.classList.add(type);
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 4000);
        }

        // Staff Dashboard Functions
        function loadStaffDashboard() {
            updateStats();
            updateAvailabilityDisplay();
            updateBookingsList();
            updateReports();
        }

        function updateStats() {
            document.getElementById('activeChannels').textContent = hotelData.channels.filter(c => c.connected).length;
            document.getElementById('pendingSync').textContent = hotelData.channels.filter(c => c.syncStatus === 'pending').length;
        }

        function showSection(sectionId) {
            document.querySelectorAll('#staffDashboard .section').forEach(section => {
                section.classList.remove('active');
            });
            document.querySelectorAll('#staffDashboard .controls button').forEach(button => {
                button.classList.remove('active');
            });
            
            document.getElementById(sectionId).classList.add('active');
            event.target.classList.add('active');
        }

        function updateAvailabilityDisplay() {
            const currency = document.getElementById('staffCurrency').value;
            const grid = document.getElementById('channelAvailabilityGrid');
            grid.innerHTML = '';
            
            hotelData.channels.forEach(channel => {
                if (!channel.connected) return;
                
                const channelCard = document.createElement('div');
                channelCard.className = 'channel-card';
                
                const lastSyncTime = channel.lastSync ? 
                    new Date(channel.lastSync).toLocaleTimeString() : 'Never';
                
                channelCard.innerHTML = `
                    <div class="channel-header">
                        <h4>${channel.name}</h4>
                        <span class="channel-status status-${channel.syncStatus}">
                            ${channel.syncStatus === 'success' ? '✅ Synced' : 
                              channel.syncStatus === 'pending' ? '🔄 Pending' : '❌ Disconnected'}
                        </span>
                    </div>
                    <div style="font-size: 12px; color: #666; margin-bottom: 15px;">
                        Last sync: ${lastSyncTime} | Commission: ${channel.commission}%
                    </div>
                    <div class="room-controls" id="controls-${channel.id}"></div>
                `;
                
                grid.appendChild(channelCard);
                updateChannelRoomControls(channel.id, currency);
            });
        }

        function updateChannelRoomControls(channelId, currency) {
            const controlsDiv = document.getElementById(`controls-${channelId}`);
            controlsDiv.innerHTML = '';
            
            hotelData.rooms.forEach(room => {
                const roomAvail = hotelData.availability[room.id][channelId];
                const roomRate = hotelData.rates[room.id][channelId];
                
                if (!roomAvail) return;
                
                const convertedPrice = convertCurrency(roomRate.channelPrice, 'USD', currency);
                
                const controlDiv = document.createElement('div');
                controlDiv.className = 'room-control';
                controlDiv.innerHTML = `
                    <div class="room-info">
                        <div class="room-name">${room.name}</div>
                        <div class="room-price">${formatCurrency(convertedPrice, currency)} | ${roomAvail.remaining} left</div>
                    </div>
                    <div class="room-actions">
                        <select onchange="updateRoomAvailability(${room.id}, ${channelId}, this.value)" 
                                ${isSyncing ? 'disabled' : ''}>
                            <option value="available" ${roomAvail.available ? 'selected' : ''}>Available</option>
                            <option value="stop-sell" ${roomAvail.stopSell ? 'selected' : ''}>Stop Sell</option>
                            <option value="closed" ${!roomAvail.available ? 'selected' : ''}>Closed</option>
                        </select>
                        <input type="number" value="${roomAvail.allocation}" 
                               onchange="updateRoomAllocation(${room.id}, ${channelId}, this.value)"
                               min="0" max="${room.totalInventory}"
                               ${isSyncing ? 'disabled' : ''}>
                    </div>
                `;
                
                controlsDiv.appendChild(controlDiv);
            });
        }

        function updateRoomAvailability(roomId, channelId, status) {
            const availability = hotelData.availability[roomId][channelId];
            
            switch(status) {
                case 'available':
                    availability.available = true;
                    availability.stopSell = false;
                    break;
                case 'stop-sell':
                    availability.available = false;
                    availability.stopSell = true;
                    break;
                case 'closed':
                    availability.available = false;
                    availability.stopSell = false;
                    break;
            }
            
            // Mark channel for sync
            const channel = hotelData.channels.find(c => c.id === channelId);
            channel.syncStatus = 'pending';
            channel.lastSync = new Date();
            
            updateStats();
            saveToLocalStorage();
            showToast(`Availability updated for ${hotelData.rooms.find(r => r.id === roomId).name} on ${channel.name}`, 'success');
        }

        function updateRoomAllocation(roomId, channelId, allocation) {
            hotelData.availability[roomId][channelId].allocation = parseInt(allocation);
            hotelData.availability[roomId][channelId].remaining = parseInt(allocation) - hotelData.availability[roomId][channelId].sold;
            
            const channel = hotelData.channels.find(c => c.id === channelId);
            channel.syncStatus = 'pending';
            
            saveToLocalStorage();
            showToast(`Allocation updated for ${hotelData.rooms.find(r => r.id === roomId).name}`, 'success');
        }

        async function syncAllChannels() {
            if (isSyncing) return;
            
            isSyncing = true;
            const syncButton = document.getElementById('syncButton');
            const progress = document.getElementById('syncProgress');
            
            syncButton.disabled = true;
            syncButton.innerHTML = '🔄 Syncing...';
            progress.style.display = 'block';
            
            try {
                // Simulate API calls to each channel
                for (const channel of hotelData.channels.filter(c => c.connected)) {
                    showToast(`Syncing with ${channel.name}...`, 'warning');
                    
                    // Simulate API delay
                    await new Promise(resolve => setTimeout(resolve, 2000));
                    
                    channel.syncStatus = 'success';
                    channel.lastSync = new Date();
                    
                    showToast(`✅ Successfully synced with ${channel.name}`, 'success');
                }
                
                lastUpdateTime = new Date();
                updateLastSyncTime();
                updateStats();
                updateAvailabilityDisplay();
                
            } catch (error) {
                showToast('❌ Sync failed for some channels. Please try again.', 'error');
            } finally {
                isSyncing = false;
                syncButton.disabled = false;
                syncButton.innerHTML = '🔄 Sync All Channels Now';
                progress.style.display = 'none';
            }
            
            saveToLocalStorage();
        }

        function updateLastSyncTime() {
            document.getElementById('lastSync').textContent = 
                `Last sync: ${lastUpdateTime.toLocaleTimeString()}`;
        }

        // Admin Dashboard Functions
        function loadAdminDashboard() {
            updateChannelConfiguration();
            updateRateManagement();
        }

        function showAdminSection(sectionId) {
            document.querySelectorAll('#adminDashboard .section').forEach(section => {
                section.classList.remove('active');
            });
            document.querySelectorAll('#adminDashboard .controls button').forEach(button => {
                button.classList.remove('active');
            });
            
            document.getElementById(sectionId).classList.add('active');
            event.target.classList.add('active');
        }

        // Enhanced Rate Management for Admin
        function updateRateManagement() {
            const currency = document.getElementById('adminCurrency').value;
            const rateControls = document.getElementById('rateControls');
            
            const grid = document.getElementById('rateChannelGrid');
            
            hotelData.channels.forEach(channel => {
                if (!channel.connected) return;
                
                const channelCard = document.createElement('div');
                channelCard.className = 'channel-card';
                channelCard.innerHTML = `
                    <div class="channel-header">
                        <h4>${channel.name} Pricing</h4>
                        <span style="font-size: 12px; color: #666;">Commission: ${channel.commission}%</span>
                    </div>
                    <div style="margin: 10px 0;">
                        <label style="display: block; margin-bottom: 5px; font-weight: 600;">Channel-Specific Adjustment:</label>
                        <div style="display: flex; gap: 5px;">
                            <input type="number" id="channelAdjustment-${channel.id}" value="5" min="1" max="50" style="width: 80px; padding: 6px; border: 1px solid #ddd; border-radius: 4px;">
                            <select id="channelAdjustmentType-${channel.id}" style="padding: 6px; border: 1px solid #ddd; border-radius: 4px;">
                                <option value="percent">%</option>
                                <option value="fixed">${currency}</option>
                            </select>
                            <button onclick="applyChannelRateAdjustment(${channel.id})" style="padding: 6px 10px; background: var(--secondary); color: white; border: none; border-radius: 4px; cursor: pointer;">Apply</button>
                        </div>
                    </div>
                    <div class="room-controls" id="rate-controls-${channel.id}"></div>
                `;
                
                grid.appendChild(channelCard);
                updateChannelRateControls(channel.id, currency);
            });
        }

        function updateChannelRateControls(channelId, currency) {
            const controlsDiv = document.getElementById(`rate-controls-${channel.id}`);
            controlsDiv.innerHTML = '';
            
            hotelData.rooms.forEach(room => {
                const roomRate = hotelData.rates[room.id][channelId];
                if (!roomRate) return;
                
                const priceChange = roomRate.channelPrice - roomRate.basePrice;
                const changePercent = ((priceChange / roomRate.basePrice) * 100).toFixed(1);
                const convertedBase = convertCurrency(roomRate.basePrice, 'USD', currency);
                const convertedCurrent = convertCurrency(roomRate.channelPrice, 'USD', currency);
                const convertedMin = convertCurrency(roomRate.minPrice, 'USD', currency);
                const convertedMax = convertCurrency(roomRate.maxPrice, 'USD', currency);
                
                const controlDiv = document.createElement('div');
                controlDiv.className = 'room-control';
                controlDiv.innerHTML = `
                    <div class="room-info">
                        <div class="room-name">${room.name}</div>
                        <div class="room-price">
                            Base: ${formatCurrency(convertedBase, currency)} | 
                            Current: <strong>${formatCurrency(convertedCurrent, currency)}</strong>
                            <span style="color: ${priceChange >= 0 ? '#27ae60' : '#e74c3c'}; font-size: 12px;">
                                (${priceChange >= 0 ? '+' : ''}${changePercent}%)
                            </span>
                        </div>
                    </div>
                    <div class="room-actions">
                        <div style="display: flex; gap: 5px; margin-bottom: 5px;">
                            <input type="number" 
                                   value="${roomRate.channelPrice}" 
                                   onchange="updateRoomPrice(${room.id}, ${channelId}, this.value)"
                                   min="${roomRate.minPrice}" 
                                   max="${roomRate.maxPrice}"
                                   style="width: 100px; padding: 5px; border: 1px solid #ddd; border-radius: 4px;">
                        </div>
                        <span style="font-size: 11px; color: #666;">
                            Min: ${formatCurrency(convertedMin, currency)} | Max: ${formatCurrency(convertedMax, currency)}
                        </span>
                    </div>
                `;
                
                controlsDiv.appendChild(controlDiv);
            });
        }

        // Rate Adjustment Functions
        function applyGlobalRateAdjustment() {
            const adjustmentValue = parseFloat(document.getElementById('globalRateAdjustment').value);
            const adjustmentType = document.getElementById('adjustmentType').value;
            
            if (isNaN(adjustmentValue) || adjustmentValue <= 0) {
                showToast('Please enter a valid adjustment value', 'error');
                return;
            }
            
            const confirmAction = confirm(`Apply ${adjustmentValue}${adjustmentType === 'percent' ? '%' : hotelData.hotel.currency} ${adjustmentValue > 0 ? 'increase' : 'decrease'} to ALL room rates across ALL channels?`);
            
            if (!confirmAction) return;
            
            hotelData.rooms.forEach(room => {
                hotelData.channels.forEach(channel => {
                    if (channel.connected && hotelData.rates[room.id] && hotelData.rates[room.id][channel.id]) {
                        const roomRate = hotelData.rates[room.id][channel.id];
                        let newPrice;
                        
                        if (adjustmentType === 'percent') {
                            const adjustment = roomRate.channelPrice * (adjustmentValue / 100);
                            newPrice = Math.round(roomRate.channelPrice + adjustment);
                        } else {
                            newPrice = Math.round(roomRate.channelPrice + adjustmentValue);
                        }
                        
                        // Ensure new price is within min/max bounds
                        roomRate.channelPrice = Math.max(roomRate.minPrice, Math.min(roomRate.maxPrice, newPrice));
                        
                        // Mark channel for sync
                        channel.syncStatus = 'pending';
                    }
                });
            });
            
            updateRateManagement();
            saveToLocalStorage();
            showToast(`✅ All rates adjusted by ${adjustmentValue}${adjustmentType === 'percent' ? '%' : hotelData.hotel.currency}`, 'success');
        }

        function applyChannelRateAdjustment(channelId) {
            const channel = hotelData.channels.find(c => c.id === channelId);
            const adjustmentValue = parseFloat(document.getElementById(`channelAdjustment-${channelId}`).value);
            const adjustmentType = document.getElementById(`channelAdjustmentType-${channelId}`).value;
            
            if (isNaN(adjustmentValue) || adjustmentValue <= 0) {
                showToast('Please enter a valid adjustment value', 'error');
                return;
            }
            
            hotelData.rooms.forEach(room => {
                if (hotelData.rates[room.id] && hotelData.rates[room.id][channelId]) {
                    const roomRate = hotelData.rates[room.id][channelId];
                    let newPrice;
                    
                    if (adjustmentType === 'percent') {
                        const adjustment = roomRate.channelPrice * (adjustmentValue / 100);
                        newPrice = Math.round(roomRate.channelPrice + adjustment);
                    } else {
                        newPrice = Math.round(roomRate.channelPrice + adjustmentValue);
                    }
                    
                    roomRate.channelPrice = Math.max(roomRate.minPrice, Math.min(roomRate.maxPrice, newPrice));
                }
            });
            
            channel.syncStatus = 'pending';
            updateRateManagement();
            saveToLocalStorage();
            showToast(`✅ ${channel.name} rates adjusted by ${adjustmentValue}${adjustmentType === 'percent' ? '%' : hotelData.hotel.currency}`, 'success');
        }

        // Dynamic Pricing Functions for Expedia and Hotel Website
        function applyExpediaPricing() {
            const demand = parseFloat(document.getElementById('expediaDemand').value) || 0;
            const competitor = parseFloat(document.getElementById('expediaCompetitor').value) || 0;
            const seasonal = parseFloat(document.getElementById('expediaSeasonal').value) || 0;
            
            const expediaChannel = hotelData.channels.find(c => c.name === "Expedia");
            
            showToast('🔄 Applying Expedia dynamic pricing strategy...', 'warning');
            
            setTimeout(() => {
                hotelData.rooms.forEach(room => {
                    if (hotelData.rates[room.id] && hotelData.rates[room.id][expediaChannel.id]) {
                        const roomRate = hotelData.rates[room.id][expediaChannel.id];
                        
                        // Expedia-specific pricing algorithm
                        const demandMultiplier = 1 + (demand / 100);
                        const competitorMultiplier = 1 + (competitor / 100);
                        const seasonalMultiplier = 1 + (seasonal / 100);
                        
                        // Expedia tends to be more competitive
                        const expediaMultiplier = 0.95; // Slight discount for Expedia competitiveness
                        
                        const newPrice = Math.round(
                            roomRate.basePrice * 
                            demandMultiplier * 
                            competitorMultiplier * 
                            seasonalMultiplier *
                            expediaMultiplier
                        );
                        
                        roomRate.channelPrice = Math.max(roomRate.minPrice, Math.min(roomRate.maxPrice, newPrice));
                    }
                });
                
                expediaChannel.syncStatus = 'pending';
                updateRateManagement();
                saveToLocalStorage();
                showToast(`✅ Expedia pricing strategy applied! (Demand: ${demand}%, Competitor: ${competitor}%, Seasonal: ${seasonal}%)`, 'success');
            }, 1500);
        }

        function applyWebsitePricing() {
            const discount = parseFloat(document.getElementById('websiteDiscount').value) || 0;
            const loyalty = parseFloat(document.getElementById('websiteLoyalty').value) || 0;
            const earlyBird = parseFloat(document.getElementById('websiteEarlyBird').value) || 0;
            
            const websiteChannel = hotelData.channels.find(c => c.name === "Hotel Website");
            
            showToast('🔄 Applying Hotel Website pricing strategy...', 'warning');
            
            setTimeout(() => {
                hotelData.rooms.forEach(room => {
                    if (hotelData.rates[room.id] && hotelData.rates[room.id][websiteChannel.id]) {
                        const roomRate = hotelData.rates[room.id][websiteChannel.id];
                        
                        // Hotel Website pricing strategy - encourage direct bookings
                        const directDiscount = 1 - (discount / 100);
                        const loyaltyBonus = 1 - (loyalty / 100);
                        const earlyBirdMultiplier = 1 - (earlyBird / 100);
                        
                        // Website gets best pricing to encourage direct bookings
                        const newPrice = Math.round(
                            roomRate.basePrice * 
                            directDiscount * 
                            loyaltyBonus * 
                            earlyBirdMultiplier
                        );
                        
                        roomRate.channelPrice = Math.max(roomRate.minPrice, Math.min(roomRate.maxPrice, newPrice));
                    }
                });
                
                websiteChannel.syncStatus = 'pending';
                updateRateManagement();
                saveToLocalStorage();
                showToast(`✅ Hotel Website pricing strategy applied! (Direct Discount: ${discount}%, Loyalty: ${loyalty}%, Early Bird: ${earlyBird}%)`, 'success');
            }, 1500);
        }

        // New function for Booking.com pricing
        function applyBookingPricing() {
            const adjustment = parseFloat(document.getElementById('bookingAdjustment').value) || 0;
            const bookingChannel = hotelData.channels.find(c => c.name === "Booking.com");
            
            showToast('🔄 Applying Booking.com pricing adjustment...', 'warning');
            
            setTimeout(() => {
                hotelData.rooms.forEach(room => {
                    if (hotelData.rates[room.id] && hotelData.rates[room.id][bookingChannel.id]) {
                        const roomRate = hotelData.rates[room.id][bookingChannel.id];
                        
                        // Booking.com pricing adjustment
                        const adjustmentMultiplier = 1 + (adjustment / 100);
                        
                        const newPrice = Math.round(
                            roomRate.basePrice * 
                            adjustmentMultiplier
                        );
                        
                        roomRate.channelPrice = Math.max(roomRate.minPrice, Math.min(roomRate.maxPrice, newPrice));
                    }
                });
                
                bookingChannel.syncStatus = 'pending';
                updateRateManagement();
                saveToLocalStorage();
                showToast(`✅ Booking.com pricing adjustment applied! (Adjustment: ${adjustment}%)`, 'success');
            }, 1500);
        }

        function updateRoomPrice(roomId, channelId, price) {
            const room = hotelData.rooms.find(r => r.id === roomId);
            const channel = hotelData.channels.find(c => c.id === channelId);
            const roomRate = hotelData.rates[roomId][channelId];
            
            const newPrice = parseInt(price);
            
            if (newPrice < roomRate.minPrice) {
                showToast(`❌ Price cannot be below $${roomRate.minPrice} for ${room.name}`, 'error');
                updateRateManagement(); // Refresh to show correct value
                return;
            }
            
            if (newPrice > roomRate.maxPrice) {
                showToast(`❌ Price cannot exceed $${roomRate.maxPrice} for ${room.name}`, 'error');
                updateRateManagement(); // Refresh to show correct value
                return;
            }
            
            roomRate.channelPrice = newPrice;
            channel.syncStatus = 'pending';
            
            saveToLocalStorage();
            showToast(`✅ ${room.name} price updated to $${newPrice} on ${channel.name}`, 'success');
        }

        function applyDynamicPricing() {
            showToast('🔄 Analyzing market conditions and applying dynamic pricing...', 'warning');
            
            // Simulate smart pricing algorithm
            setTimeout(() => {
                hotelData.rooms.forEach(room => {
                    hotelData.channels.forEach(channel => {
                        if (channel.connected && hotelData.rates[room.id] && hotelData.rates[room.id][channel.id]) {
                            const roomRate = hotelData.rates[room.id][channel.id];
                            
                            // Simulate dynamic pricing factors
                            const demandMultiplier = 1 + (Math.random() * 0.3); // 0-30% increase based on demand
                            const competitorMultiplier = 0.95 + (Math.random() * 0.1); // -5% to +5% vs competitors
                            
                            const newPrice = Math.round(roomRate.basePrice * demandMultiplier * competitorMultiplier);
                            roomRate.channelPrice = Math.max(roomRate.minPrice, Math.min(roomRate.maxPrice, newPrice));
                            
                            channel.syncStatus = 'pending';
                        }
                    });
                });
                
                updateRateManagement();
                saveToLocalStorage();
                showToast('✅ Smart pricing applied based on current market conditions!', 'success');
            }, 2000);
        }

        function resetToBaseRates() {
            const confirmAction = confirm('Reset all rates to base prices? This will remove all adjustments.');
            
            if (!confirmAction) return;
            
            hotelData.rooms.forEach(room => {
                hotelData.channels.forEach(channel => {
                    if (channel.connected && hotelData.rates[room.id] && hotelData.rates[room.id][channel.id]) {
                        const roomRate = hotelData.rates[room.id][channel.id];
                        roomRate.channelPrice = roomRate.basePrice;
                        channel.syncStatus = 'pending';
                    }
                });
            });
            
            updateRateManagement();
            saveToLocalStorage();
            showToast('✅ All rates reset to base prices', 'success');
        }

        async function syncRateChanges() {
            if (isSyncing) return;
            
            isSyncing = true;
            const syncButton = document.getElementById('rateSyncButton');
            
            syncButton.disabled = true;
            syncButton.innerHTML = '🔄 Syncing Rate Changes...';
            
            try {
                // Simulate API calls to each channel
                for (const channel of hotelData.channels.filter(c => c.connected)) {
                    showToast(`Syncing rate changes with ${channel.name}...`, 'warning');
                    
                    // Simulate API delay
                    await new Promise(resolve => setTimeout(resolve, 1500));
                    
                    channel.syncStatus = 'success';
                    channel.lastSync = new Date();
                    
                    showToast(`✅ Rate changes synced with ${channel.name}`, 'success');
                }
                
                lastUpdateTime = new Date();
                updateRateManagement();
                
            } catch (error) {
                showToast('❌ Rate sync failed for some channels. Please try again.', 'error');
            } finally {
                isSyncing = false;
                syncButton.disabled = false;
                syncButton.innerHTML = '🔄 Sync Rate Changes to All Channels';
            }
            
            saveToLocalStorage();
        }

        function updateBookingsList() {
            const bookingsList = document.getElementById('bookingsList');
            bookingsList.innerHTML = `
                <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.05);">
                    <h4>Recent Bookings (${hotelData.bookings.length})</h4>
                    ${hotelData.bookings.map(booking => {
                        const room = hotelData.rooms.find(r => r.id === booking.roomId);
                        return `
                            <div class="room-control">
                                <div class="room-info">
                                    <div class="room-name">${room.name} - ${booking.guestName}</div>
                                    <div class="room-price">
                                        ${new Date(booking.checkIn).toLocaleDateString()} - ${new Date(booking.checkOut).toLocaleDateString()}
                                    </div>
                                </div>
                                <div class="room-actions">
                                    <span style="color: var(--success); font-weight: bold;">$${booking.totalAmount}</span>
                                    <span class="channel-tag">${booking.channel}</span>
                                </div>
                            </div>
                        `;
                    }).join('')}
                </div>
            `;
        }

        function updateReports() {
            const reportsContent = document.getElementById('reportsContent');
            reportsContent.innerHTML = `
                <div class="admin-grid">
                    <div class="admin-card">
                        <h4>Channel Performance</h4>
                        <div style="margin: 15px 0;">
                            ${hotelData.channels.filter(c => c.connected).map(channel => `
                                <div class="room-control">
                                    <span>${channel.name}</span>
                                    <span>${Math.floor(Math.random() * 50) + 20} bookings</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
        }

        function updateChannelConfiguration() {
            const connectedChannels = document.getElementById('connectedChannels');
            const apiSettings = document.getElementById('apiSettings');
            
            connectedChannels.innerHTML = '';
            apiSettings.innerHTML = '';
            
            hotelData.channels.forEach(channel => {
                // Connected channels list
                const channelDiv = document.createElement('div');
                channelDiv.className = 'room-control';
                channelDiv.innerHTML = `
                    <div class="room-info">
                        <div class="room-name">${channel.name}</div>
                        <div class="room-price">
                            ${channel.connected ? 
                                `✅ Connected | Last sync: ${channel.lastSync ? new Date(channel.lastSync).toLocaleDateString() : 'Never'}` : 
                                '❌ Disconnected'}
                        </div>
                    </div>
                    <div class="room-actions">
                        <button onclick="toggleChannel(${channel.id})" 
                                style="padding: 6px 12px; background: ${channel.connected ? 'var(--danger)' : 'var(--success)'}; color: white; border: none; border-radius: 4px; cursor: pointer;">
                            ${channel.connected ? 'Disconnect' : 'Connect'}
                        </button>
                        <button onclick="testChannelConnection(${channel.id})"
                                style="padding: 6px 12px; background: var(--secondary); color: white; border: none; border-radius: 4px; cursor: pointer;">
                            Test
                        </button>
                        <button onclick="removeChannel(${channel.id})"
                                style="padding: 6px 12px; background: var(--danger); color: white; border: none; border-radius: 4px; cursor: pointer;">
                            Remove
                        </button>
                    </div>
                `;
                connectedChannels.appendChild(channelDiv);
                
                // API settings
                if (channel.connected) {
                    const apiDiv = document.createElement('div');
                    apiDiv.className = 'room-control';
                    apiDiv.innerHTML = `
                        <div class="room-info">
                            <div class="room-name">${channel.name} API</div>
                            <div class="room-price">Endpoint: ${channel.endpoint}</div>
                        </div>
                        <div class="room-actions">
                            <input type="text" value="${channel.apiKey}" 
                                   onchange="updateApiKey(${channel.id}, this.value)"
                                   style="width: 200px; padding: 5px; border: 1px solid #ddd; border-radius: 4px;">
                            <span style="font-size: 12px; color: #666;">Commission: ${channel.commission}%</span>
                        </div>
                    `;
                    apiSettings.appendChild(apiDiv);
                }
            });
        }

        // New function to remove channel
        function removeChannel(channelId) {
            const channel = hotelData.channels.find(c => c.id === channelId);
            const confirmAction = confirm(`Are you sure you want to remove ${channel.name}?`);
            
            if (!confirmAction) return;
            
            // Remove channel from channels array
            hotelData.channels = hotelData.channels.filter(c => c.id !== channelId);
            
            // Remove channel from availability data
            hotelData.rooms.forEach(room => {
                if (hotelData.availability[room.id]) {
                    delete hotelData.availability[room.id][channelId];
                }
            });
            
            // Remove channel from rates data
            hotelData.rooms.forEach(room => {
                if (hotelData.rates[room.id]) {
                    delete hotelData.rates[room.id][channelId];
                }
            });
            
            updateChannelConfiguration();
            saveToLocalStorage();
            showToast(`✅ ${channel.name} has been removed`, 'success');
        }

        function toggleChannel(channelId) {
            const channel = hotelData.channels.find(c => c.id === channelId);
            channel.connected = !channel.connected;
            
            if (channel.connected) {
                channel.syncStatus = 'pending';
                showToast(`✅ ${channel.name} connected successfully`, 'success');
            } else {
                showToast(`❌ ${channel.name} disconnected`, 'warning');
            }
            
            updateChannelConfiguration();
            saveToLocalStorage();
        }

        function testChannelConnection(channelId) {
            const channel = hotelData.channels.find(c => c.id === channelId);
            showToast(`Testing connection to ${channel.name}...`, 'warning');
            
            // Simulate API test
            setTimeout(() => {
                showToast(`✅ ${channel.name} connection test successful`, 'success');
            }, 2000);
        }

        function updateApiKey(channelId, newKey) {
            const channel = hotelData.channels.find(c => c.id === channelId);
            channel.apiKey = newKey;
            saveToLocalStorage();
            showToast(`API key updated for ${channel.name}`, 'success');
        }

        function showAddChannelModal() {
            document.getElementById('addChannelModal').style.display = 'flex';
        }

        function hideAddChannelModal() {
            document.getElementById('addChannelModal').style.display = 'none';
        }

        function addNewChannel(event) {
            event.preventDefault();
            
            const name = document.getElementById('newChannelName').value;
            const apiKey = document.getElementById('newChannelAPI').value;
            const endpoint = document.getElementById('newChannelURL').value;
            
            const newChannel = {
                id: Math.max(...hotelData.channels.map(c => c.id)) + 1,
                name: name,
                connected: true,
                apiKey: apiKey,
                endpoint: endpoint,
                lastSync: new Date(),
                syncStatus: 'pending',
                commission: 15.0
            };
            
            hotelData.channels.push(newChannel);
            
            // Initialize availability and rates for new channel
            hotelData.rooms.forEach(room => {
                if (!hotelData.availability[room.id]) hotelData.availability[room.id] = {};
                if (!hotelData.rates[room.id]) hotelData.rates[room.id] = {};
                
                hotelData.availability[room.id][newChannel.id] = {
                    available: true,
                    allocation: Math.floor(room.totalInventory * 0.5),
                    sold: 0,
                    remaining: Math.floor(room.totalInventory * 0.5),
                    stopSell: false
                };
                
                hotelData.rates[room.id][newChannel.id] = {
                    basePrice: room.basePrice,
                    channelPrice: Math.round(room.basePrice * 1.15),
                    minPrice: Math.round(room.basePrice * 0.8),
                    maxPrice: Math.round(room.basePrice * 1.4)
                };
            });
            
            hideAddChannelModal();
            updateChannelConfiguration();
            saveToLocalStorage();
            showToast(`✅ ${name} added successfully`, 'success');
            
            return false;
        }

        // Load stats on page load
        function loadStats() {
            // Stats would be loaded from API in real implementation
            console.log('Loading hotel statistics...');
        }

        // Initialize the application when page loads
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });
    </script>
</body>
</html>